# get_work_result_flet

SES企業やエンジニア向けの勤怠管理・給与明細管理・稼働計算を効率化するためのデスクトップアプリケーションです。  
PythonのGUIフレームワーク Flet を使用して構築されています。

## **🚀 主な機能**

### **1\. 💰 給与明細 自動取得 & サマリー**

Web上の給与明細サイトからデータを自動でスクレイピングし、ローカルで一元管理します。

* **自動取得**: ログインID/PWを用いてサイトへアクセスし、明細データを取得。  
* **サマリー表示**: 年間の総支給額、手取り額、残業時間、有給残日数などをカード形式で可視化。  
* **CSV出力**: 取得したデータを「給与」「賞与」それぞれのCSVファイルとして保存・蓄積。  
* **暗号化保存**: ログイン情報はPC固有の情報を利用して暗号化され、.envファイルに安全に保存されます。

### **2\. 📅 勤務表 作成支援 & 一括入力**

Web勤怠システムへの入力作業を自動化・効率化します。

* **一括入力**: ローカルで編集した一ヶ月分の勤務データを、Web勤怠システムへワンクリックでPOST送信（一括登録）。  
* **スケジュール取り込み**:  
  * **PDF解析**: 会社から配布されるスケジュールのPDF（帰社会日程など）を解析し、自動で「帰社会」等の予定を反映。  
  * **JSON取り込み**: 独自形式のJSONファイルからのスケジュール取り込みにも対応。  
* **入力支援**:  
  * 定時（9:30-18:00など）のワンクリック入力。  
  * 曜日ごとの拡張設定（在宅勤務、定型コメントの自動挿入など）。  
  * バリデーションチェック（時間の不整合などを送信前に検知）。

### **3\. 🧮 稼働見込 計算**

当月・次月の営業日数を計算し、必要な稼働時間をシミュレーションします。

* **自動計算**: 土日祝日を考慮した所定労働日数を自動算出。  
* **カスタマイズ**:  
  * **特別休暇**: 年末年始や夏季休暇などをJSONファイル (special\_holidays.json) で管理可能。  
  * **祝日設定**: 祝日を「稼働日」とするか「休日」とするかの切り替えが可能。

## **💻 動作環境**

* **OS**: Windows 10/11 (推奨)  
* **Python**: 3.10 以上  
* **Google Chrome**: スクレイピング実行時に必要となる場合があります（本ツールはrequestsを使用していますが、環境によってはブラウザ操作が必要になる可能性があります）。

## **🛠️ インストール手順**

1. **リポジトリのクローン**  
   git clone \<repository-url\>  
   cd get\_work\_result\_flet

2. **仮想環境の作成と有効化 (推奨)**  
   python \-m venv venv  
   \# Windows  
   venv\\Scripts\\activate  
   \# Mac/Linux  
   source venv/bin/activate

3. **依存ライブラリのインストール**  
   pip install \-r requirements.txt

   ※ cryptography, flet, requests, beautifulsoup4, pdfplumber などがインストールされます。

## **▶️ 実行方法**

以下のコマンドでアプリケーションを起動します。

python main.py  
\# または  
flet run main.py

初回起動時に .env ファイルが自動生成されます。GUI上で設定したログイン情報はここに保存されます。

## **📁 ディレクトリ構成**

.  
├── core/  
│   ├── commons.py          \# 定数、ロガー設定、モック処理  
│   ├── icon\_data.py        \# アプリケーションアイコン(Base64)  
│   └── main\_controller.py  \# アプリ全体のロジック制御  
├── data/                   \# アプリケーションデータ保存用  
│   ├── Internal\_meeting/   \# 帰社会PDF/JSON保存先  
│   └── special\_holidays.json \# 特別休暇設定ファイル  
├── handlers/               \# Web操作・スクレイピングハンドラ  
│   ├── base\_handler.py     \# 基底クラス  
│   ├── payslip\_handler.py  \# 給与明細サイト操作  
│   └── schedule\_handler.py \# 勤怠サイト操作  
├── output/                 \# 出力ファイル保存先  
│   ├── app.log             \# アプリケーションログ  
│   ├── debug\_network\_log.txt \# 通信デバッグログ  
│   └── \*.csv               \# 取得した給与・賞与データCSV  
├── utils/                  \# ユーティリティ  
│   ├── csv\_handler.py      \# CSV操作  
│   ├── date\_utils.py       \# 日付計算  
│   ├── encryption\_utils.py \# 暗号化・復号化 (MACアドレスベース)  
│   ├── json\_utils.py       \# JSON操作  
│   ├── pdf\_schedule\_reader.py \# PDF解析  
│   └── summary\_calculator.py \# 集計ロジック  
├── views/                  \# UIコンポーネント (Flet)  
│   ├── components/         \# 勤務表画面の部品化  
│   │   ├── schedule\_actions.py  
│   │   ├── schedule\_settings.py  
│   │   └── schedule\_table.py  
│   ├── estimate\_view.py    \# 稼働見込画面  
│   ├── home\_view.py        \# ホーム画面  
│   ├── payslip\_view.py     \# 給与明細画面  
│   └── schedule\_view.py    \# 勤務表画面  
├── main.py                 \# エントリーポイント  
└── requirements.txt        \# 依存ライブラリ一覧

## **⚙️ 設定・データ管理**

### **環境変数 (.env)**

アプリケーションの設定値は .env ファイルに保存されます。  
セキュリティ上の注意:  
ログインIDやパスワードは、utils/encryption\_utils.py により、実行マシンのMACアドレスをキーとして暗号化されて保存されます。そのため、.env ファイルを別のPCにコピーしても、パスワードは復号できず使用できません。

### **CSVデータ (output/)**

取得した給与データは output ディレクトリにCSVとして蓄積されます。

* 年間サマリー\_全期間.csv: 毎月の給与明細データ  
* 年間賞与\_全期間.csv: 賞与データ

既存のCSVがある場合、新規取得時にデータがマージ（追記・更新）されます。

### **特別休暇設定 (data/special\_holidays.json)**

「稼働見込」画面で使用される特別休暇リストです。  
形式: \["YYYY-MM-DD", "YYYY-MM-DD", ...\]

## **⚠️ 免責事項**

* 本ツールは特定のWebサイト（給与明細サイト・勤怠管理サイト）のHTML構造に依存しています。サイト側の仕様変更により、予告なく動作しなくなる可能性があります。  
* スクレイピングを行う際は、対象サイトの利用規約を遵守してください。  
* 本ツールの使用によって生じた、いかなる損害（データの損失、入力ミスによるトラブル等）についても、開発者は責任を負いません。必ずご自身で入力内容を確認の上、実行してください。
